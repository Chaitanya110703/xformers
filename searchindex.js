Search.setIndex({docnames:["components/attentions","components/feedforward","components/index","components/mha","components/position_embedding","components/reversible","custom_parts/index","factory/block","factory/index","factory/model","index","tutorials/blocksparse","tutorials/extend_attentions","tutorials/index","tutorials/pytorch_encoder","tutorials/reversible","tutorials/sparse_vit","tutorials/triton","tutorials/use_attention","what_is_xformers"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["components/attentions.rst","components/feedforward.rst","components/index.rst","components/mha.rst","components/position_embedding.rst","components/reversible.rst","custom_parts/index.rst","factory/block.rst","factory/index.rst","factory/model.rst","index.rst","tutorials/blocksparse.rst","tutorials/extend_attentions.rst","tutorials/index.rst","tutorials/pytorch_encoder.rst","tutorials/reversible.rst","tutorials/sparse_vit.rst","tutorials/triton.rst","tutorials/use_attention.rst","what_is_xformers.rst"],objects:{xformers:{triton:[6,0,0,"-"]}},objnames:{"0":["py","module","Python module"]},objtypes:{"0":"py:module"},terms:{"1024":[11,14,18],"1182":14,"128":14,"151mb":11,"1536":14,"155":14,"1950":14,"1e3":11,"1e6":11,"2017":15,"2020":15,"2021":17,"2048":[11,14],"224":16,"2709":14,"3080":17,"384":[14,18],"393mb":11,"4117":14,"512":14,"619m":11,"837m":11,"\u0142":15,"boolean":15,"break":19,"case":[14,16,17,18],"catch":14,"class":[12,15],"default":[6,12,14],"export":6,"float":[12,14],"function":[11,15,16],"import":[11,14,16,17,18],"int":[12,14,15],"new":[12,14,18,19],"return":[14,16],"short":17,"true":[6,11,12,14,15,17],"try":[11,14],"while":14,And:19,Doing:12,For:14,Its:[14,15],One:15,PRs:19,That:18,The:[6,11,12,14,15,16,17,18],There:[6,12,14,17,18],These:[6,17],Using:[10,13],With:14,__init__:[12,15],_self_:14,_target_:14,_you:11,abl:6,ablat:19,abov:[6,14,15,16],abs:14,accept:12,accuraci:15,across:19,activ:[6,14,15],actual:[11,17],adapt:15,add_modul:16,added:14,adding:14,advanc:14,affect:15,after:11,against:19,agnost:19,aim:19,all:[10,12,13,15,17,18,19],allow:[18,19],alon:19,along:[11,14,17],alreadi:[11,14,16],also:[6,12,14,15,17,19],alter:16,altern:[14,16,18],although:18,alwai:14,amp:17,ani:[6,12,16,17,19],anoth:15,anyth:[11,19],anytim:19,api:[10,14,18],appl:14,appli:[12,15],applic:[12,14,15,17],architectur:[12,14,18,19],architur:6,arg:12,arg_rout:15,argument:12,art:[10,19],aspect:16,assum:14,att_mask:[11,16],att_val:11,attend:14,attent:[2,6,10,11,12,13,14,15],attention_nam:18,attention_pattern:16,attention_query_mask:18,attentionconfig:12,attn_drop:14,attn_mask:[11,16],autograd:17,autom:14,automat:[6,12,19],avail:17,awar:[16,17],backend:17,backpropag:15,base:[6,10,12,13,16,18],basi:14,basic:14,batch:[11,12,14,18],batch_first:[11,14],batch_submit:12,becaus:14,becom:[15,18],being:[11,17,19],below:14,benchmark:[8,12,14,17,19],benchmark_pytorch_transform:14,benchmark_triton_dropout:17,benchmark_triton_layernorm:17,benefit:15,better:[11,17],between:[11,15],bia:14,bias:11,binari:11,block:[6,8,10,11,12,13,19],block_config:15,block_siz:11,block_typ:14,blockif:11,blockspars:11,blocksparseattent:[10,13],bonu:11,bookeep:11,bool:[12,15],both:12,bruegger:15,build:[10,11,13,15,18,19],build_attent:18,build_model:14,built:[14,18],call:12,can:[6,10,11,12,14,15,16,17,18,19],cannot:[14,19],capabl:[6,17],care:14,causal:[11,12,14],causal_layout:11,causal_mask:11,chang:[6,11,14],check:[14,16],checkpo:12,checkpoint:15,child:16,chosen:14,chunk:15,clear:16,clone:6,close:[14,15],closer:16,cluster:12,code:[6,12,17,18],coeffici:11,com:6,combin:[10,15,18],commandlin:14,commod:11,common:6,commun:15,compar:[10,11,13,15,17,19],comparison:14,compat:[15,17],compil:[6,17],complet:[8,15,18],compon:[10,11,12,15,16,18],compos:19,comprehens:6,comput:[6,11,15],conda:6,condit:6,config:[12,14],config_path:12,configur:12,consid:[12,14,15,16],consolid:17,constitut:14,construct:[11,12,14],constructor:[12,14],context:15,conv_kernel_s:12,convent:14,convert:11,correspond:17,cost:15,could:[11,14],coupl:[6,12,14,17],creat:[6,10],crowd:19,cuda:[10,11,16,17],current:[6,14,17],custom:[10,14],custom_decod:14,custom_encod:14,d_model:14,data:[11,18],dataclass:12,ddp:15,deal:15,declar:14,decod:14,decoder_nystrom_favor:14,dedic:12,def:[11,12,15,16],defer:18,defin:[11,12,14,15,16,19],definit:18,del:16,demonstr:14,dens:11,depend:18,depth:16,design:19,detail:15,develop:8,devic:[11,14,18],dict:18,dict_kei:14,differ:[11,12,14,15],dim:[15,16],dim_feedforward:14,dim_model:[11,14,18],dimens:[11,14,17,18],directli:[12,14,17,18],dispatch:18,distribut:15,doc:14,doe:15,domain:19,don:14,done:12,dot:[6,14],drop:[11,14,17],dropout:[11,12,14,18],dtype:[11,14],dummi:[14,18],duplic:14,each:[17,19],earli:14,easi:19,easili:[14,18,19],effect:15,effici:15,effort:19,either:[17,18],element:14,emb:[11,14],embed:[2,10,14],embed_dim:16,empti:11,empty_cach:11,enabl:[6,12,17],encod:[10,13],encoder_config:14,encoder_loc:14,encoder_random:14,encodinhg:14,engin:19,enough:[6,11],entir:14,env:6,equival:[10,13,14],error:14,evalu:14,even:12,everi:[14,19],everyth:[14,18],exact:[12,14],exactli:15,exampl:[6,10,11,14,16,17],exchang:16,exempl:14,exhaust:16,exhibit:16,exist:[10,13,14],expect:[14,17,18],experi:16,explicit:14,explicitli:12,expos:[12,14,15,16,18],extend:[10,13,14,19],extens:[12,19],extra:[11,12,15,16],f_arg:15,fact:11,factori:[10,15],fairintern:6,fairli:14,fals:[12,14,15,16,17],famili:17,fast:[11,19],faster:17,favor:14,featur:14,feedforward:[2,10,14,15],feedforward_config:14,few:14,field:[12,19],file:18,fine:[11,18],first:[14,15],flag:18,flexibl:[10,14,19],float16:11,focu:19,focus:19,follow:[6,12,14,15,16,17,19],forget:14,fork:12,formul:15,forward:[11,12,14,15],fp16:17,free:[14,15],friendli:14,from:[6,10,11,12,13,14,15,17,18],from_config:14,full:[10,13],fullfil:6,fusedlayernorm:14,fusedlinearlay:17,futur:14,g_arg:15,gcc:6,gener:14,get:[11,15,16,17],git:6,github:6,given:[12,16,18,19],glr:17,goal:17,gomez:15,good:16,gpu:[6,15,17],grain:11,gross:15,half:11,happen:19,has:14,have:[11,14,16],head:[2,10,11,14,15,18],head_:11,heavi:19,help:15,helper:[11,15,16,18],here:[10,11,13,14],hidden_layer_multipli:14,hierarchi:14,hoc:17,hopefulli:18,host:[10,13],how:[16,17],html:17,http:17,idea:16,ideal:19,imag:16,img_siz:16,implement:[6,14,15],improv:19,in_featur:[14,17],in_proj_contain:14,includ:[14,15],increas:[15,17],independ:6,inform:12,inherit:12,initi:18,inplac:14,inprojcontain:14,input:[14,15,18],inspir:19,instal:6,instanc:12,instanti:[14,18],interest:[10,13,14],interfac:[12,14,17],intern:18,interoper:[10,19],inv_iter:12,isinst:16,issu:6,jit:17,job:[12,14],json:12,just:[11,14,16,17],kaiser:15,keep:14,kei:11,kernel:[10,17],kitaev:15,knob:14,kwarg:[11,12,15],landmark_pool:12,lang:17,languag:17,laptop:17,larg:15,last:17,launch:14,layer:[2,10,13,15],layer_norm_ep:14,layer_norm_styl:14,layernorm:16,layout:11,lead:14,least:12,length:11,less:[6,15],let:[11,12,14,16],leverag:14,levskaya:15,librari:[10,14,19],lightli:15,like:[12,14,15,16,17,18],limit:[6,11,17],line:[11,17],linear:14,linform:14,list:14,littl:[14,18],load:6,local:[12,14,17,19],localattent:14,log:[12,17],log_softmax:17,look:[11,14],loos:12,loss:14,lot:[14,18],lower:11,lra:[12,14],lsh:15,lucidrain:15,machin:6,made:15,mai:[14,16],main:15,make:[11,14,15,17,18],mani:[14,17],manual:16,mask:[6,11,14,16,18],match:[6,11],matrix:11,max_memori:11,max_memory_alloc:11,maxpool:11,mean:[14,15,19],measur:[17,19],mechan:[2,10,12,13,14,16],mem_us:11,memori:[11,14,15],met:6,mha:[14,15],mind:[11,16],minim:[14,16],minimum:11,mlp:[14,15],mlp_ratio:16,model:[6,8,10,13,15,18,19],model_factori:[14,15],modul:[6,12,15,16],module_output:16,modulelist:[14,15],monkei:16,more:[11,12,14,15,16,18,19],moreov:15,mostli:14,move:19,multi:[2,10,15,18],multi_head:[11,18],multi_head_config:14,multi_head_config_cross:14,multi_head_config_mask:14,multihead:[11,18],multiheadattent:11,multiheaddispatch:[11,14,18],multipl:[14,15],multirun:14,my_component_nam:12,my_config:[14,18],my_fancy_mask:16,my_linear_lay:17,my_model:14,name:[6,12,14,16,18],named_children:16,natur:15,need:[6,11,12,14,15],negat:14,network:15,nhead:14,non:17,none:[12,14,17],norm:[14,15],norm_lay:16,note:[11,14,15,16],notebook:16,noth:6,now:[11,12,14,16],num_decoder_lay:14,num_encoder_lay:14,num_head:[11,12,14,16,18],num_landmark:12,num_lay:[14,15],number:[15,17],nvcc:6,nvidia:[14,17],nystrom:[12,14],nystromattent:12,nystromselfattentionconfig:12,object:14,obscur:18,offer:14,often:6,one:[11,12,14,15,16,19],ones:11,onli:[6,10,13,17],open:[12,15],oper:17,operand:17,opposit:14,optim:[10,17,19],option:[8,10,12,14,15],order:12,org:17,origin:15,other:[12,14,15,16,17,19],our:[11,16],out:[10,11,13,14],out_featur:[14,17],output:[15,16],over:17,overrid:14,own:18,packag:14,paper:[12,15],parallel:17,paramet:[14,16,18],part:[10,13,14],particular:[11,16],pass:[11,15],patch:16,patch_siz:16,path:[12,14,15,18],pattern:[11,16],peak:11,per:[11,14],perfect:11,perform:17,permut:14,pick:12,pinverse_original_init:12,pip:6,pleas:[11,14,15,16],point:[12,14,17],pose_encod:14,posit:[2,10,14],position_embed:14,position_encoding_config:14,possibl:[11,14,17,18],post:14,postnorm:14,power:11,practic:[12,16],pre:14,precis:16,prefer:14,prenorm:14,present:6,primarili:8,primit:[14,17],print:[11,14],privat:12,probabl:[11,14],process:15,produc:15,product:[6,14],program:17,programat:[10,18],progress:12,proj:14,propos:[14,15,16,17,19],provid:[6,11,17,18],pure:[14,17],purpos:8,put:14,pytest:12,python3:[12,14,17],python:[6,14,17],pytorch:[10,11,13,16,17],pytorch_multihead:11,pytorchtransform:14,qkv:16,qkv_bia:16,queri:11,quit:14,rand:[14,18],randn:11,random:11,randomattent:14,readm:12,realli:[11,14,19],recipi:6,recommend:12,recov:15,recurs:16,refer:[10,16,19],reform:15,regist:12,register_attent:12,registr:12,relat:[6,15],relev:[12,19],relu:[14,17],remark:12,remind:12,remov:11,ren:15,repeat:14,replac:[10,13,14,17],replace_attn_with_xformers_on:16,replic:14,repo:19,report:11,repositori:[15,16],reproduc:17,requir:[11,12,15],requires_grad:11,requires_head_dimens:18,reset_peak_memory_stat:11,resid_drop:14,residu:[14,15],residual_dropout:[11,14,18],respons:11,result:[11,14,17],reus:[16,19],revers:[2,10,13,14],reversibleblock:15,reversiblesequ:15,robin:15,round:11,rout:15,run:[11,14,17],run_task:12,runtim:[6,14],sai:16,said:14,same:[12,14,15],save:[14,15],scale:[6,14],scaleddotproduct:16,search:[18,19],see:[6,14,15],self:[11,12,15],sens:14,septemb:17,seq:[11,14,18],seq_len:[11,14,18],sequenc:[11,14,15,17,18],sequenti:[14,15],serv:17,set:[6,14,15],setup:6,sever:16,shape:[14,16],share:12,should:[14,15,18],show:16,sigmoid:17,similar:[14,17,18],similarli:[14,15],simpl:11,simpli:17,sinc:19,size:11,skip:17,slow:6,slurm:12,small:11,snipper:16,snippet:12,some:[6,10,11,14,15,16,17,18],somebodi:19,someth:[11,12,14,15,18],sourc:[6,16,19],spars:[10,11,13],sparsifi:16,sparsiti:16,specif:[6,19],speed:14,sphx:17,sputnik:6,squared_relu:17,src:14,stack:[14,15],stack_config:14,start:[11,14,17],state:[10,19],step:14,still:11,stop:11,store:15,straightforward:18,studi:19,sublay:14,submit:12,suggest:6,support:[6,14,16,17],suppos:16,sure:18,sweep:[14,18],synchron:11,systemat:14,take:[15,16,18],taken:14,task:12,tensor:[12,14,15,16,17],test:[10,12,13,14,19],tgt:14,than:[6,11,14,15,17],thei:[6,8,10],them:[12,15,17],thi:[11,12,14,15,16,17,18,19],thing:12,think:14,three:12,through:19,throughput:17,ties:12,tile:11,time:[11,14,17],timm:16,timmattentionwrapp:16,titl:11,too:19,tool:12,toolbox:12,toolchain:17,top:14,torch:[11,12,14,15,16,17,18],torch_cuda_arch_list:6,toward:11,tradeoff:15,train:14,tranform:[14,17],transform:[10,16,17,19],transformerencoderlay:14,translat:16,transpar:6,triangular:11,trigger:[6,12],tril:11,triton:[10,11,13,14],turn:[14,15,18],tutori:[6,10,14,17],two:[11,15,17,18],txt:6,type:[12,14],typic:[16,17],union:15,unit:[12,14,17],unload:6,unrel:15,urtasun:15,use:[6,11,14,15,16,17,18],use_razavi_pinvers:12,usecas:17,used:[6,12,14,16,17],useful:12,uses:[11,14],using:[6,15,17],v100:[11,14,17],v_skip_connect:12,valu:[6,11,14,19],vanilla:14,variabl:6,variant:[12,19],variat:16,vaswani:[14,15],veri:[14,15,17,18],verifi:15,version:6,via:15,visibl:6,vision_transform:16,visiontransform:16,vit:[10,13],vocab:14,vocab_s:14,vocabembed:14,wai:14,walk:14,want:[6,12,16],warn:6,weight:16,welcom:19,well:16,were:8,what:14,whatev:14,when:[6,14,15,16,17],where:11,wherea:14,whether:[15,18],which:[6,10,11,12,14,15,16,17,18,19],whole:14,without:15,word_embed:14,work:[12,16,18],world_siz:12,worth:14,would:[12,14,16,18],wrap:15,wrap_att:14,wrap_ff:14,xformer:[6,11,13,15,16,17,18],xformer_env:6,xformerconfig:14,xformerdecoderconfig:15,xformerencoderblock:14,xformerencoderconfig:[14,15],xformerstackconfig:15,yet:15,you:[6,11,12,14,15,16,17,18,19],your:[12,14,15,18],zoo:[10,13,19]},titles:["Attention mechanisms","Feedforward mechanisms","API Reference","Multi Head Attention","Position Embeddings","Reversible layer","Custom parts reference","Block factory","Factory","Model factory","Welcome to xFormers\u2019s documentation!","Using BlockSparseAttention","Extend the xFormers parts zoo","Tutorials","Building an encoder, comparing to PyTorch","Using the Reversible block","Replace all attentions from an existing ViT model with a sparse equivalent?","Using Triton-based layers","I\u2019m only interested in testing out the attention mechanisms that are hosted here","What is xFormers?"],titleterms:{Using:[11,15,17],activ:17,all:16,api:2,attent:[0,3,16,18],base:17,bia:17,block:[7,14,15],blocksparseattent:11,build:[6,14],compar:14,cuda:6,custom:6,document:10,dropout:17,embed:4,encod:14,equival:16,exist:16,extend:12,factori:[7,8,9,14],feedforward:1,from:16,full:14,fuse:17,head:3,here:18,host:18,hydra:14,interest:18,intro:15,kernel:6,layer:[5,14,17],linear:17,mechan:[0,1,18],model:[9,14,16],multi:3,norm:17,onli:18,out:18,part:[6,12],posit:4,possibl:6,practic:15,pytorch:14,refer:[2,6],replac:16,requir:6,revers:[5,15],softmax:17,spars:[6,16],test:18,transform:[14,15],triton:[6,17],tutori:13,usag:6,vit:16,warn:14,welcom:10,what:19,xformer:[10,12,14,19],zoo:12}})